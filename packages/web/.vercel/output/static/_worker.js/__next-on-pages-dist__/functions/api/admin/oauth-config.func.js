var V=Object.defineProperty;var H=Object.getOwnPropertyDescriptor;var W=Object.getOwnPropertyNames;var Q=Object.prototype.hasOwnProperty;var Y=(i,h)=>()=>(i&&(h=i(i=0)),h);var B=(i,h,I,l)=>{if(h&&typeof h=="object"||typeof h=="function")for(let k of W(h))!Q.call(i,k)&&k!==I&&V(i,k,{get:()=>h[k],enumerable:!(l=H(h,k))||l.enumerable});return i},G=(i,h,I)=>(B(i,h,"default"),I&&B(I,h,"default"));var Z=i=>B(V({},"__esModule",{value:!0}),i);var F={};import*as He from"async_hooks";var X=Y(()=>{G(F,He)});import{__getNamedExports as ee}from"../../../../__next-on-pages-dist__/webpack/bdec9f97dc450b9d877b52222a283bc1.js";import{__getNamedExports as te}from"../../../../__next-on-pages-dist__/manifest/537259e2ed205f5a7994cb4f05664668.js";var R=globalThis.__nextOnPagesRoutesIsolation.getProxyFor("/api/admin/oauth-config"),n=ee(R,R,R),ne=n.__chunk_195,_e=n.__chunk_67,re=n.__chunk_388,oe=n.__chunk_342,ce=n.__chunk_757,ue=n.__chunk_381,ae=n.__chunk_361,ie=n.__chunk_882,se=n.__chunk_937,he=n.__chunk_924,pe=n.__chunk_319,fe=n.__chunk_19,de=n.__chunk_492,le=n.__chunk_229,ke=n.__chunk_648,ge=n.__chunk_865,me=n.__chunk_299,Ee=n.__chunk_716,ye=n.__chunk_50,ve=n.__chunk_351,be=n.__chunk_678,xe=n.__chunk_440,Oe=n.__chunk_923,Ne=n.__chunk_105,Re=n.__chunk_743,we=n.__chunk_850,Se=n.__chunk_586,Te=n.__chunk_736,Ce=n.__chunk_919,Ae=n.__chunk_427,je=n.__chunk_560,Ie=n.__chunk_435,Pe=n.__chunk_57,Me=n.__chunk_257,Fe=n.__chunk_281,Le=n.__chunk_742,Ue=n.__chunk_400,De=n.__chunk_682,$e=n.__chunk_478,Ke=n.__chunk_314,qe=n.__chunk_773,Be=n.__chunk_170,Ge=n.__chunk_811,Je=n.__chunk_354,z=te(R,R,R),Ve=z.__NEXT_FONT_MANIFEST,Xe=z.__REACT_LOADABLE_MANIFEST,Ye=((i,h,I)=>(h._ENTRIES={},i.__BUILD_MANIFEST={polyfillFiles:["static/chunks/polyfills-42372ed130431b0a.js"],devFiles:[],ampDevFiles:[],lowPriorityFiles:[],rootMainFiles:["static/chunks/webpack-9c6c184dd610cc23.js","static/chunks/5b581c49-7d04a29ef44df04e.js","static/chunks/651-fbf49f55d465baa1.js","static/chunks/main-app-84cb1012d59da1d2.js"],pages:{"/_app":["static/chunks/webpack-9c6c184dd610cc23.js","static/chunks/framework-6e06c675866dc992.js","static/chunks/main-279b610c1a32cb4f.js","static/chunks/pages/_app-8f4fb87037d1670c.js"],"/_error":["static/chunks/webpack-9c6c184dd610cc23.js","static/chunks/framework-6e06c675866dc992.js","static/chunks/main-279b610c1a32cb4f.js","static/chunks/pages/_error-6c50fc1be0ed5954.js"]},ampFirstPages:[]},i.__BUILD_MANIFEST.lowPriorityFiles=["/static/43xVRVs_yQDN4IZE4UsC_/_buildManifest.js",,"/static/43xVRVs_yQDN4IZE4UsC_/_ssgManifest.js"],i.__REACT_LOADABLE_MANIFEST=Xe,i.__NEXT_FONT_MANIFEST=Ve,i.__INTERCEPTION_ROUTE_REWRITE_MANIFEST="[]",(()=>{"use strict";var l={},k={};function o(_){var a=k[_];if(a!==void 0)return a.exports;var u=k[_]={exports:{}},g=!0;try{l[_](u,u.exports,o),g=!1}finally{g&&delete k[_]}return u.exports}o.m=l,(()=>{var _=[];o.O=(a,u,g,m)=>{if(u){m=m||0;for(var p=_.length;p>0&&_[p-1][2]>m;p--)_[p]=_[p-1];_[p]=[u,g,m];return}for(var y=1/0,p=0;p<_.length;p++){for(var[u,g,m]=_[p],x=!0,s=0;s<u.length;s++)y>=m&&Object.keys(o.O).every(j=>o.O[j](u[s]))?u.splice(s--,1):(x=!1,m<y&&(y=m));if(x){_.splice(p--,1);var O=g();O!==void 0&&(a=O)}}return a}})(),o.n=_=>{var a=_&&_.__esModule?()=>_.default:()=>_;return o.d(a,{a}),a},o.d=(_,a)=>{for(var u in a)o.o(a,u)&&!o.o(_,u)&&Object.defineProperty(_,u,{enumerable:!0,get:a[u]})},o.e=()=>Promise.resolve(),o.g=function(){if(typeof h=="object")return h;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}}(),o.o=(_,a)=>Object.prototype.hasOwnProperty.call(_,a),o.r=_=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(_,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_,"__esModule",{value:!0})},(()=>{var _={993:0};o.O.j=g=>_[g]===0;var a=(g,m)=>{var p,y,[x,s,O]=m,w=0;if(x.some(M=>_[M]!==0)){for(p in s)o.o(s,p)&&(o.m[p]=s[p]);if(O)var P=O(o)}for(g&&g(m);w<x.length;w++)y=x[w],o.o(_,y)&&_[y]&&_[y][0](),_[y]=0;return o.O(P)},u=i.webpackChunk_N_E=i.webpackChunk_N_E||[];u.forEach(a.bind(null,0)),u.push=a.bind(null,u.push.bind(u))})()})(),(i.webpackChunk_N_E=i.webpackChunk_N_E||[]).push([[719],{354:Je,811:Ge,170:Be,773:qe,314:Ke,478:$e,682:De,400:Ue,742:Le,281:Fe,257:Me,57:Pe,435:Ie,560:je,427:Ae,919:Ce,736:Te,586:Se,850:we,743:Re,105:Ne,923:Oe,440:xe,678:be,351:ve,50:ye,716:Ee,299:me,865:ge,648:ke,229:le,492:de,19:fe,319:pe,924:he,937:se,882:ie,361:ae,381:ue,757:ce,342:oe,388:re}]),(i.webpackChunk_N_E=i.webpackChunk_N_E||[]).push([[451],{67:_e,195:ne,587:(l,k,o)=>{"use strict";o.r(k),o.d(k,{ComponentMod:()=>K,default:()=>q});var _={};o.r(_),o.d(_,{GET:()=>P,POST:()=>M,runtime:()=>x});var a={};o.r(a),o.d(a,{originalPathname:()=>D,patchFetch:()=>$,requestAsyncStorage:()=>j,routeModule:()=>T,serverHooks:()=>U,staticGenerationAsyncStorage:()=>L});var u=o(648),g=o(351),m=o(678),p=o(716),y=o(354);let x="edge";function s(d,v=200){return new Response(JSON.stringify(d),{status:v,headers:{"Content-Type":"application/json"}})}function O(){return s({error:"Unauthorized"},401)}function w(d){let v=d.headers.get("authorization")||d.headers.get("Authorization");return v&&v.match(/^Bearer\s+(.*)$/i)?.[1]||null}async function P(d){let v,E=(0,y.getRequestContext)(),e=E.env?.SECRETFORGE_KV,c=E.env?.ADMIN_TOKEN;if(!e)return s({error:"KV binding 'SECRETFORGE_KV' not found"},500);let r=w(d);if(!c||!r||r!==c)return O();let t=new URL(d.url).searchParams.get("provider");if(!t)return s({error:"Missing 'provider' query param"},400);let f=await e.get(`oauth:config:${t}`);if(!f)return s({error:`No config for '${t}'`},404);try{v=JSON.parse(f)}catch{return s({error:"Stored config is not valid JSON"},500)}return s({provider:t,config:v})}async function M(d){let v,E=(0,y.getRequestContext)(),e=E.env?.SECRETFORGE_KV,c=E.env?.ADMIN_TOKEN;if(!e)return s({error:"KV binding 'SECRETFORGE_KV' not found"},500);let r=w(d);if(!c||!r||r!==c)return O();try{v=await d.json()}catch{return s({error:"Body must be valid JSON"},400)}let t=(v?.provider||"").trim(),f=v?.config;return t?f?f.authorize_url&&f.token_url&&f.client_id&&f.client_secret?(await e.put(`oauth:config:${t}`,JSON.stringify(f)),s({ok:!0,provider:t})):s({error:"Config must include authorize_url, token_url, client_id, client_secret"},400):s({error:"Missing 'config'"},400):s({error:"Missing 'provider'"},400)}let T=new g.AppRouteRouteModule({definition:{kind:m.x.APP_ROUTE,page:"/api/admin/oauth-config/route",pathname:"/api/admin/oauth-config",filename:"route",bundlePath:"app/api/admin/oauth-config/route"},resolvedPagePath:"/Users/RemyMorgan-Jones/secretforge-ai/packages/web/app/api/admin/oauth-config/route.ts",nextConfigOutput:"",userland:_}),{requestAsyncStorage:j,staticGenerationAsyncStorage:L,serverHooks:U}=T,D="/api/admin/oauth-config/route";function $(){return(0,p.XH)({serverHooks:U,staticGenerationAsyncStorage:L})}let K=a,q=u.a.wrap(T)}},l=>{var k=_=>l(l.s=_);l.O(0,[719],()=>k(587));var o=l.O();(h._ENTRIES=typeof h._ENTRIES>"u"?{}:h._ENTRIES)["middleware_app/api/admin/oauth-config/route"]=o}]),function(){let l={exports:{},loaded:!1};return function(o,_){var a=Object.create,u=Object.defineProperty,g=Object.getOwnPropertyDescriptor,m=Object.getOwnPropertyNames,p=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty,x=e=>u(e,"__esModule",{value:!0}),s=(e,c)=>{x(e);for(var r in c)u(e,r,{get:c[r],enumerable:!0})},O=(e,c,r)=>{if(c&&typeof c=="object"||typeof c=="function")for(let t of m(c))!y.call(e,t)&&t!=="default"&&u(e,t,{get:()=>c[t],enumerable:!(r=g(c,t))||r.enumerable});return e},w=e=>O(x(u(e!=null?a(p(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);s(_,{default:()=>q});var P=w((X(),Z(F))),M="@next/request-context",T=Symbol.for(M),j=Symbol.for("internal.storage");function L(){let e=h;if(!e[T]){let c=new P.AsyncLocalStorage,r={get:()=>c.getStore(),[j]:c};e[T]=r}return e[T]}var U=L();function D(e,c){return U[j].run(e,c)}function $(e){let c={};return e&&e.forEach((r,t)=>{c[t]=r,t.toLowerCase()==="set-cookie"&&(c[t]=K(r))}),c}function K(e){let c=[],r=0,t,f,b,C,A;function N(){for(;r<e.length&&/\s/.test(e.charAt(r));)r+=1;return r<e.length}function S(){return f=e.charAt(r),f!=="="&&f!==";"&&f!==","}for(;r<e.length;){for(t=r,A=!1;N();)if(f=e.charAt(r),f===","){for(b=r,r+=1,N(),C=r;r<e.length&&S();)r+=1;r<e.length&&e.charAt(r)==="="?(A=!0,r=C,c.push(e.substring(t,b)),t=r):r=b+1}else r+=1;(!A||r>=e.length)&&c.push(e.substring(t,e.length))}return c}function q(e){let c=e.staticRoutes.map(t=>({regexp:new RegExp(t.namedRegex),page:t.page})),r=e.dynamicRoutes?.map(t=>({regexp:new RegExp(t.namedRegex),page:t.page}))||[];return async function(t,f){let b=new URL(t.url).pathname,C={};if(e.nextConfig?.basePath&&b.startsWith(e.nextConfig.basePath)&&(b=b.replace(e.nextConfig.basePath,"")||"/"),e.nextConfig?.i18n)for(let N of e.nextConfig.i18n.locales){let S=new RegExp(`^/${N}($|/)`,"i");if(b.match(S)){b=b.replace(S,"/")||"/";break}}for(let N of c)if(N.regexp.exec(b)){C.name=N.page;break}if(!C.name){let N=v(b);for(let S of r||[]){if(N&&!v(S.page))continue;let J=S.regexp.exec(b);if(J){C={name:S.page,params:J.groups};break}}}let A=await D({waitUntil:f.waitUntil},()=>h._ENTRIES[`middleware_${e.name}`].default.call({},{request:{url:t.url,method:t.method,headers:$(t.headers),ip:d(t.headers,E.Ip),geo:{city:d(t.headers,E.City,!0),country:d(t.headers,E.Country,!0),latitude:d(t.headers,E.Latitude),longitude:d(t.headers,E.Longitude),region:d(t.headers,E.Region,!0)},nextConfig:e.nextConfig,page:C,body:t.body}}));return A.waitUntil&&f.waitUntil(A.waitUntil),A.response}}function d(e,c,r=!1){let t=e.get(c)||void 0;return r&&t?decodeURIComponent(t):t}function v(e){return e==="/api"||e.startsWith("/api/")}var E;(function(e){e.City="x-vercel-ip-city",e.Country="x-vercel-ip-country",e.Ip="x-real-ip",e.Latitude="x-vercel-ip-latitude",e.Longitude="x-vercel-ip-longitude",e.Region="x-vercel-ip-country-region"})(E||(E={}))}(l,l.exports),l.exports}.call({}).default({name:"app/api/admin/oauth-config/route",staticRoutes:[{page:"/",regex:"^/(?:/)?$",routeKeys:{},namedRegex:"^/(?:/)?$"},{page:"/_not-found",regex:"^/_not\\-found(?:/)?$",routeKeys:{},namedRegex:"^/_not\\-found(?:/)?$"}],dynamicRoutes:[],nextConfig:{basePath:""}})))(R,R,R);export{Ye as default};
