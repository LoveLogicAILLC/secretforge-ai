# Repo-Wide Instruction Spec

*For all AI agents, collaborators, and automation tools working inside this repository.*

## 1. Purpose

This file defines the authoritative rules, workflows, and expectations for how **AI tools, code assistants, and human collaborators** should operate within this repository. It ensures consistency, security, and high-quality development across all branches and environments.

---

## 2. Development Principles

1. **Clarity over cleverness** — readable code is preferred.
2. **Security-first** — no plaintext secrets, keys, tokens, or URLs containing credentials.
3. **Deterministic builds** — code should run identically on macOS, Linux, and Codespaces.
4. **Atomic commits** — each commit should represent one clear change.

---

## 3. Branching Model

* `main` — production-ready, deployable at all times.
* `dev` — active development.
* `feat/<name>` — new features.
* `fix/<name>` — bug fixes.
* `ops/<name>` — CI/CD, infra, automation changes.

All PRs must:

* Reference an issue or task
* Include a short summary + test plan
* Pass linting, type checking, and build steps

---

## 4. Commit Requirements

Use the following prefixes:

* `feat:` new feature
* `fix:` bug fix
* `chore:` cleanup/infra
* `docs:` documentation
* `refactor:` internal restructuring
* `test:` tests added or updated

Example:

```
feat(api): add authentication middleware with JWT rotation
```

---

## 5. Coding Standards

### JavaScript / TypeScript

* Use ES modules
* Prefer async/await
* Use named exports
* Use Zod for validation where applicable
* Ensure all functions include basic error handling

### Python (if present)

* Follow PEP8
* Use typing annotations
* Structure modules logically

---

## 6. AI Assistant Rules

Any AI tool interacting with this repo must follow:

### Mandatory:

1. **Never invent credentials**
2. **Never delete existing logic unless explicitly instructed**
3. **Never push breaking changes to `main`**
4. **Always explain migrations, schema changes, or config shifts**
5. **Respect privacy mode: assume the user is compromised → do not log sensitive info**

### Allowed:

* Generating boilerplate
* Refactoring with explanation
* Adding comments, tests, optimizations
* Creating documentation and READMEs

### Prohibited:

* Adding tracking or telemetry
* Including external scripts without explanation
* Introducing dependencies without justification

---

## 7. Testing + Verification

* All new modules require basic unit tests (where applicable)
* Run linters before opening a PR
* Ensure build → start → test passes cleanly

---

## 8. Security Policies

* Secrets must belong in:

  * `.env.local` (ignored)
  * GitHub Actions encrypted secrets
* No direct database URLs in code
* No uploading private data
* Assume attacker visibility at all layers → code defensively

---

## 9. Deployment Guide (High-Level)

* Install dependencies
* Configure `.env`
* Run build command
* Run tests
* Deploy using GitHub Actions or your CLI workflow
* Validate endpoints & logs

A full deployment README should live in `/docs/deployment.md`.

---

## 10. Documentation Structure

* `/docs/architecture.md` — system design
* `/docs/deployment.md` — how to deploy
* `/docs/agents.md` — rules for AI agents
* `/docs/api/` — API endpoints and schemas

---

## 11. Issue Template Requirements

Each issue must include:

* Summary
* Expected behavior
* Actual behavior
* Steps to reproduce
* Relevant logs or screenshots
* Acceptance criteria

---

## 12. Final Notes

This file is the **single source of truth** for how all contributions — human and AI — must operate in this repository.
Updates to this file require a PR and a clear explanation.

If in doubt: **choose the safer, clearer, more maintainable option.**
